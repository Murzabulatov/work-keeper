(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{163:function(e,t,a){e.exports=a(255)},168:function(e,t,a){},169:function(e,t,a){},193:function(e,t,a){},219:function(e,t){},243:function(e,t){},245:function(e,t){},253:function(e,t,a){},254:function(e,t,a){},255:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(12),l=a.n(c),o=(a(168),a(169),a(17)),u=a.n(o),i=a(26),s=a(20),m=a(6),p=a(9),d=a(298),E=a(315),f=a(136),b=a.n(f),g=a(54),O=a(313),j=a(300),v=a(296),h=a(293),y=a(15),k=a(8),I=function(e){return console.log("ACTION_CREATOR_REGISTRATION",e),{type:"REGISTRATION",payload:Object(m.a)({},e)}},N=function(e){return{type:"LOGIN",payload:Object(m.a)({},e)}},S=Object(h.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1),fontSize:20},submit:{margin:e.spacing(3,0,2)}}})),_=function(e){var t=e.title,a=e.isReg,c=S(),l=Object(y.g)(),o=r.a.useRef(),f=Object(n.useState)({}),h=Object(p.a)(f,2),_=h[0],w=h[1],D=Object(n.useState)(""),C=Object(p.a)(D,2),x=C[0],R=C[1],T=Object(k.b)();function A(e){var t=e.target,a=t.value,n=t.name;w(Object(m.a)(Object(m.a)({},_),{},Object(s.a)({},n,a)))}function M(){return(M=Object(i.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log(_),e.prev=2,e.next=5,fetch("".concat("https://workkeeper.ru","/user/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)});case 5:return a=e.sent,e.next=8,a.json();case 8:n=e.sent,console.log("LOGIN",n),a.ok?(T(N(n)),T({type:"IS_ME",payload:{}}),w({email:"",password:""}),l.push("/")):R(n.message),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})))).apply(this,arguments)}function F(){return(F=Object(i.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,fetch("".concat("https://workkeeper.ru","/user/registration"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)});case 4:return a=e.sent,e.next=7,a.json();case 7:n=e.sent,console.log("REGISTRATION",n),a.ok?(T(I(n)),T({type:"IS_ME",payload:{}}),w({name:"",email:"",password:""}),l.push("/")):R(n.message),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}return r.a.createElement(v.a,{component:"main",maxWidth:"xs"},r.a.createElement(d.a,null),r.a.createElement("div",{className:c.paper},r.a.createElement(E.a,{className:c.avatar},r.a.createElement(b.a,null)),r.a.createElement(g.a,{component:"h1",variant:"h5"},t),r.a.createElement("form",{ref:o,onSubmit:a?function(e){return F.apply(this,arguments)}:function(e){return M.apply(this,arguments)},className:c.form,noValidate:!0},a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{variant:"outlined",margin:"normal",fullWidth:!0,name:"name",label:"\u0418\u043c\u044f",id:"name",autoComplete:"current-password",onChange:A,autoFocus:!0,required:!0}),r.a.createElement(O.a,{variant:"outlined",margin:"normal",fullWidth:!0,name:"surname",label:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",id:"surname",autoComplete:"current-password",onChange:A,required:!0})),r.a.createElement(O.a,{variant:"outlined",margin:"normal",fullWidth:!0,id:"email",label:"Email",name:"email",autoComplete:"email",onChange:A,required:!0,autoFocus:!0}),r.a.createElement(O.a,{variant:"outlined",margin:"normal",fullWidth:!0,name:"password",label:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",id:"password",autoComplete:"current-password",onChange:A,required:!0}),r.a.createElement("span",{style:{color:"red",fontSize:"small"}},x),r.a.createElement(j.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:c.submit,onClick:function(){return o.current.reportValidity()}},t))))},w=function(){return r.a.createElement(_,{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",isReg:!0})};var D=function(){return r.a.createElement(_,{title:"\u0412\u043e\u0439\u0442\u0438"})},C=a(74);var x=function(e){var t=e.children,a=Object(C.a)(e,["children"]),n=Object(k.c)((function(e){return e.aboutMe}));return console.log(n),r.a.createElement(y.b,Object.assign({},a,{render:function(e){var a=e.location;return n.isMe?t:r.a.createElement(y.a,{to:{pathname:"/user/login",state:{from:a}}})}}))},R=a(87),T=a.n(R),A=(a(193),a(34)),M=function(e,t){switch(t.type){case"JOINED":return Object(m.a)(Object(m.a)({},e),{},{joined:!0,userName:t.payload.userName,roomId:t.payload.roomId});case"SET_DATA":return Object(m.a)(Object(m.a)({},e),{},{users:t.payload.users,messages:t.payload.messages});case"SET_USERS":return Object(m.a)(Object(m.a)({},e),{},{users:t.payload});case"NEW_MESSAGE":return Object(m.a)(Object(m.a)({},e),{},{messages:[].concat(Object(A.a)(e.messages),[t.payload])});default:return e}};var F=function(e){var t=e.users,a=e.messages,c=e.userName,l=e.roomId,o=e.onAddMessage,u=e.socketRef,i=e.userInfo,s=r.a.useState(""),m=Object(p.a)(s,2),d=m[0],E=m[1],f=r.a.useRef(null);return Object(n.useEffect)((function(){f.current.scrollTo(0,99999)}),[a]),r.a.createElement("div",{className:"chat"},r.a.createElement("div",{className:"chat-users"},r.a.createElement("b",null,"\u041e\u043d\u043b\u0430\u0439\u043d (",t.length,"):"),r.a.createElement("ul",null,t.map((function(e,t){return r.a.createElement("li",{key:e+t},e)})))),r.a.createElement("div",{className:"chat-messages"},r.a.createElement("div",{ref:f,className:"messages"},a.map((function(e,t){return e.userName===i?r.a.createElement("div",{key:t,style:{textAlign:"right"},className:"message"},r.a.createElement("p",{style:{backgroundColor:"#29648A"}},e.text),r.a.createElement("div",null,r.a.createElement("span",null,e.userName))):r.a.createElement("div",{key:t,className:"message"},r.a.createElement("p",null,e.text),r.a.createElement("div",null,r.a.createElement("span",null,e.userName)))}))),r.a.createElement("form",null,r.a.createElement("textarea",{value:d,onChange:function(e){return E(e.target.value)},className:"form-control",rows:"3"}),r.a.createElement(j.a,{onClick:function(){d.trim()&&(u.current.emit("ROOM:NEW_MESSAGE",{userName:c,roomId:l,text:d}),o({userName:c,text:d}),E(""))},type:"button",className:"btn btn-primary"},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"))))},W=a(73),G=a.n(W);var z=function(){var e=Object(k.c)((function(e){return e.user})),t=e.name,a=e.surname,c=Object(n.useRef)(),l=Object(n.useReducer)(M,{joined:!1,roomId:null,userName:null,users:[],messages:[]}),o=Object(p.a)(l,2),s=o[0],m=o[1],d={roomId:"123",userName:t+" "+a};Object(n.useEffect)((function(){return c.current=G.a.connect("https://workkeeper.ru"),Object(i.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.post("".concat("https://workkeeper.ru","/rooms"),d);case 2:return m({type:"JOINED",payload:d}),c.current.emit("ROOM:JOIN",d),e.next=6,T.a.get("".concat("https://workkeeper.ru","/rooms/").concat(d.roomId));case 6:t=e.sent,a=t.data,m({type:"SET_DATA",payload:a});case 9:case"end":return e.stop()}}),e)})))(),function(){c.current.disconnect()}}),[]);var E=function(e){m({type:"SET_USERS",payload:e})},f=function(e){m({type:"NEW_MESSAGE",payload:e})};return Object(n.useEffect)((function(){c.current.on("ROOM:SET_USERS",E),c.current.on("ROOM:NEW_MESSAGE",f)}),[]),r.a.createElement(F,Object.assign({userInfo:t+" "+a},s,{socketRef:c,onAddMessage:f}))},P=a(88),B=a.n(P),J=a(137),U=a.n(J),L=a(138),K=a.n(L),V=a(139),q=a.n(V),H=a(140),Y=a.n(H),Z=(a(253),function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){e.peer.on("stream",(function(e){t.current.srcObject=e}))}),[]),r.a.createElement("video",{autoPlay:!0,ref:t})}),X=function(e){var t=Object(n.useState)([]),a=Object(p.a)(t,2),c=a[0],l=a[1],o=Object(n.useRef)(),u=Object(n.useRef)(),i=Object(n.useRef)([]),s=e.match.params.roomID,d=Object(n.useRef)(),E=Object(n.useState)(!0),f=Object(p.a)(E,2),b=f[0],g=f[1],O=Object(n.useState)(!1),j=Object(p.a)(O,2),v=j[0],h=j[1];return Object(n.useEffect)((function(){return o.current=G.a.connect("https://workkeeper.ru"),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){u.current.srcObject=e,d.current=e,d.current.getAudioTracks()[0].enabled=v,o.current.emit("join room",s),o.current.on("all users",(function(t){var a=[];t.forEach((function(t){var n=function(e,t,a){var n=new B.a({initiator:!0,trickle:!1,stream:a});return n.on("signal",(function(a){o.current.emit("sending signal",{userToSignal:e,callerID:t,signal:a})})),n}(t,o.current.id,e);i.current.push({peerID:t,peer:n}),a.push({peerID:t,peer:n})})),l(a)})),o.current.on("user joined",(function(t){var a=function(e,t,a){var n=new B.a({initiator:!1,trickle:!1,stream:a});return n.on("signal",(function(e){o.current.emit("returning signal",{signal:e,callerID:t})})),n.signal(e),n}(t.signal,t.callerID,e);console.log(i.current),i.current.push({peerID:t.callerID,peer:a});var n={peer:a,peerID:t.callerID};console.log(i.current,n,"!!!!!!!"),console.log(n.peer._id,"peer id"),l((function(e){return e.map((function(e){return e.peerID!==n.peerID?Object(m.a)({},e):Object(m.a)({},n)}))}))})),o.current.on("receiving returned signal",(function(e){i.current.find((function(t){return t.peerID===e.id})).peer.signal(e.signal)})),o.current.on("user left",(function(e){var t=i.current.find((function(t){return t.peerID===e}));t&&t.peer.destroy();var a=i.current.filter((function(t){return t.peerID!==e}));i.current=a,l(a)}))})),function(){d.current.getTracks().forEach((function(e){return e.stop()})),o.current.close()}}),[]),Object(n.useEffect)((function(){d.current&&d.current.getVideoTracks()[0]&&d.current.getVideoTracks()[0].enabled!==b&&(d.current.getVideoTracks()[0].enabled=b),d.current&&d.current.getAudioTracks()[0]&&d.current.getAudioTracks()[0].enabled!==v&&(d.current.getAudioTracks()[0].enabled=v)}),[b,v]),console.log(c),r.a.createElement("div",{className:"videochat-container"},r.a.createElement("div",{className:"videochat-user"},r.a.createElement("video",{muted:!0,ref:u,autoPlay:!0}),r.a.createElement("div",{className:"videochat-user-buttons"},v?r.a.createElement("button",{onClick:function(){return h((function(e){return!e}))}},r.a.createElement(U.a,null)," "):r.a.createElement("button",{className:"red",onClick:function(){return h((function(e){return!e}))}},r.a.createElement(K.a,null)," "),b?r.a.createElement("button",{onClick:function(){return g((function(e){return!e}))}},r.a.createElement(q.a,null)," "):r.a.createElement("button",{className:"red",onClick:function(){return g((function(e){return!e}))}},r.a.createElement(Y.a,null)," "))),r.a.createElement("div",{className:"videochat-companions"},c.map((function(e){return r.a.createElement(Z,{key:e.peerID,peer:e.peer})}))))},Q=a(301),$=a(305),ee=a(303),te=a(304),ae=a(302),ne=function(e,t){return{type:"DEP_TO_ORG",payload:{orgID:e,depID:t}}},re=function(e,t){return{type:"DEP_ADD_DEP",payload:{orgID:e,depObject:t}}},ce=function(e,t,a){return{type:"WORKER_TO_DEP",payload:{orgID:e,depID:t,workerObj:a}}};function le(e){var t=e.open,a=e.handleClose,c=Object(n.useState)(""),l=Object(p.a)(c,2),o=l[0],s=l[1],d=Object(k.b)(),E=function(){var e=Object(i.a)(u.a.mark((function e(){var t,n,r,c,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(),t=JSON.parse(localStorage.getItem("redux")),n=t.user.userID,console.log(n),e.prev=3,r={nameOrg:o,userID:n},e.next=7,fetch("".concat("https://workkeeper.ru","/organization"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 7:return c=e.sent,e.next=10,c.json();case 10:l=e.sent,console.log("\u041f\u041e\u0421\u041b\u0415 \u0414\u041e\u0411\u0410\u0412\u041b\u0415\u041d\u0418\u042f \u041e\u0420\u0413",l),c.ok&&(d((u=l,{type:"ORG_ADD_ORG",payload:Object(m.a)({},u)})),d({type:"ORG_KEY_IN_DEP",payload:{orgID:l._id}})),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.log(e.t0);case 18:case"end":return e.stop()}var u}),e,null,[[3,15]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Q.a,{open:t,onClose:a,"aria-labelledby":"form-dialog-title"},r.a.createElement(ae.a,{id:"form-dialog-title"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044e"),r.a.createElement(ee.a,null,r.a.createElement(te.a,null,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0432\u0430\u0448\u0435\u0439 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438/\u043f\u0440\u0435\u0434\u043f\u0440\u0438\u044f\u0442\u0438\u044f:"),r.a.createElement("form",null,r.a.createElement(O.a,{margin:"dense",id:"name",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",type:"text",fullWidth:!0,onChange:function(e){return s(e.target.value)},autoFocus:!0}))),r.a.createElement($.a,null,r.a.createElement(j.a,{onClick:a,color:"primary"},"\u041e\u0442\u043c\u0435\u043d\u0430"),r.a.createElement(j.a,{onClick:E,color:"primary"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")))}var oe=a(16),ue=function(e){var t=e.name;return r.a.createElement("div",null,t)},ie=r.a.createContext(),se=function(){console.log("RENDER profile");var e=Object(k.c)((function(e){return e.organizations})),t=r.a.useState(!1),a=Object(p.a)(t,2),c=a[0],l=a[1],o=Object(n.useContext)(ie).isCreator,u=Object(k.c)((function(e){return e.departments})),i=Object(k.c)((function(e){return e.user}));return r.a.createElement(r.a.Fragment,null,o?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"profile__page"},r.a.createElement(j.a,{variant:"outlined",color:"primary",onClick:function(){l(!0)}},"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044e"),c&&r.a.createElement(le,{open:c,handleClose:function(){l(!1)}})),r.a.createElement("div",null,e.length?r.a.createElement("ul",{className:"org-list "},e.map((function(e){return r.a.createElement(oe.b,{to:"/organization/".concat(e._id),key:e._id},r.a.createElement("li",{className:"org-list-task"},r.a.createElement(ue,e)))}))):r.a.createElement("p",null,"\u041d\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0439"))):r.a.createElement(r.a.Fragment,null,Object.keys(u)?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null," \u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0439 ",i.name+" "+i.surname,", \u0437\u0434\u0435\u0441\u044c \u043f\u0435\u0440\u0435\u0447\u0438\u0441\u043b\u0435\u043d\u044b \u0434\u0435\u043f\u0430\u0440\u0442\u0430\u043c\u0435\u043d\u0442\u044b: ")):r.a.createElement("p",null," \u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0439 ",i.name+" "+i.surname,", \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435, \u043f\u043e\u043a\u0430 \u0412\u0430\u0441 \u0434\u043e\u0431\u0430\u0432\u044f\u0442 \u0432 \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u043e\u0432 \u043d\u0430 \u0441\u0430\u0439\u0442\u0435 ")))},me=a(3),pe=a(28),de=a(314),Ee=a(306),fe=a(307),be=a(299),ge=a(309),Oe=a(308),je=a(141),ve=a.n(je),he=a(143),ye=a.n(he),ke=a(142),Ie=a.n(ke),Ne=a(310),Se=a(311),_e=a(312),we=a(144),De=a.n(we),Ce=a(149),xe=a.n(Ce),Re=a(150),Te=a.n(Re),Ae=a(148),Me=a.n(Ae),Fe=a(147),We=a.n(Fe),Ge=a(145),ze=a.n(Ge),Pe=a(146),Be=a.n(Pe),Je=(a(254),Object(h.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:240,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:Object(s.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1},e.breakpoints.up("sm"),{width:e.spacing(9)+1}),toolbar:Object(m.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),content:{flexGrow:1,padding:e.spacing(3)}}})));function Ue(e){var t,a,n=e.children,c=Object(k.c)((function(e){return e.aboutMe})),l=Object(k.c)((function(e){return e.user})),o=l.userID,u=(l.name,l.surname,Object(k.b)()),i=Je(),m=Object(pe.a)(),E=r.a.useState(!1),f=Object(p.a)(E,2),b=f[0],g=f[1];return r.a.createElement("div",{className:i.root},r.a.createElement(d.a,null),r.a.createElement(Ee.a,{position:"fixed",className:Object(me.a)(i.appBar,Object(s.a)({},i.appBarShift,b))},r.a.createElement(fe.a,null,r.a.createElement(Oe.a,{color:"inherit","aria-label":"open drawer",onClick:function(){g(!0)},edge:"start",className:Object(me.a)(i.menuButton,Object(s.a)({},i.hide,b))},r.a.createElement(ve.a,null)))),r.a.createElement(de.a,{variant:"permanent",className:Object(me.a)(i.drawer,(t={},Object(s.a)(t,i.drawerOpen,b),Object(s.a)(t,i.drawerClose,!b),t)),classes:{paper:Object(me.a)((a={},Object(s.a)(a,i.drawerOpen,b),Object(s.a)(a,i.drawerClose,!b),a))}},r.a.createElement("div",{className:i.toolbar},r.a.createElement(Oe.a,{onClick:function(){g(!1)}},"rtl"===m.direction?r.a.createElement(Ie.a,null):r.a.createElement(ye.a,null))),r.a.createElement(ge.a,null),r.a.createElement("div",{className:"menu-items"},r.a.createElement(be.a,null,r.a.createElement(oe.b,{to:"/",className:"nav-link"},r.a.createElement(Ne.a,{button:!0},r.a.createElement(Se.a,null,r.a.createElement(De.a,null)),r.a.createElement(_e.a,null,"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"))),c.isMe?r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.b,{to:"/videochat",className:"nav-link"},r.a.createElement(Ne.a,{button:!0},r.a.createElement(Se.a,null,r.a.createElement(ze.a,null)),r.a.createElement(_e.a,null,"\u0412\u0438\u0434\u0435\u043e"))),r.a.createElement(oe.b,{to:"/global-chat",className:"nav-link"},r.a.createElement(Ne.a,{button:!0},r.a.createElement(Se.a,null,r.a.createElement(Be.a,null)),r.a.createElement(_e.a,null,"\u0427\u0430\u0442")))):""),r.a.createElement(ge.a,null),r.a.createElement(be.a,null,c.isMe?r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.b,{to:"/profile/".concat(o),className:"nav-link"},r.a.createElement(Ne.a,{button:!0},r.a.createElement(Se.a,null,r.a.createElement(We.a,null)),r.a.createElement(_e.a,null,"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442"))),r.a.createElement(oe.b,{to:"/user/registration",className:"nav-link",onClick:function(){u({type:"LOGOUT",payload:{}}),u({type:"IS_NOT_ME",payload:{}}),localStorage.clear()}},r.a.createElement(Ne.a,{button:!0},r.a.createElement(Se.a,null,r.a.createElement(Me.a,null)),r.a.createElement(_e.a,null,"\u0412\u044b\u0439\u0442\u0438")))):r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.b,{className:"nav-link",to:"/user/registration"},r.a.createElement(Ne.a,{button:!0},r.a.createElement(Se.a,null,r.a.createElement(xe.a,null)),r.a.createElement(_e.a,null,"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"))),r.a.createElement(oe.b,{className:"nav-link",to:"/user/login"},r.a.createElement(Ne.a,{button:!0},r.a.createElement(Se.a,null,r.a.createElement(Te.a,null)),r.a.createElement(_e.a,null,"\u0412\u043e\u0439\u0442\u0438"))))))),r.a.createElement("main",{className:i.content},r.a.createElement("div",{className:i.toolbar}),n))}var Le=function(e){return{type:"MAIN_IS_CREATOR",payload:{isCreator:e}}},Ke=function(e){return{type:"MAIN_USER",payload:e}},Ve=function(e,t){return{type:"MAIN_DEPARTMENTS",payload:{orgID:e,departments:t}}},qe=function(e){return{type:"MAIN_ORGANIZATIONS",payload:{organization:e}}},He=function(){var e=Object(k.b)(),t=Object(k.c)((function(e){return e.user})).userID,a=Object(n.useContext)(ie).isCreator,c=Object(n.useState)([]),l=Object(p.a)(c,2),o=l[0],s=l[1],m=Object(n.useState)(""),d=Object(p.a)(m,2),E=d[0],f=d[1],b=Object(n.useState)({}),g=Object(p.a)(b,2),O=g[0],j=g[1];return Object(n.useEffect)((function(){Object(i.a)(u.a.mark((function a(){var n,r,c,l,o,i,m,p,d;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,fetch("".concat("https://workkeeper.ru","/organization/?userID=").concat(t));case 3:return n=a.sent,a.next=6,n.json();case 6:r=a.sent,console.log("INFO_FOR_MAIN_PAGE",r),n.ok&&(c=r.departments,l=r.organization,o=r.isCreator,i=Object(C.a)(r,["departments","organization","isCreator"]),console.log(i),c.length&&(m=c[0].organization,p=m.orgID,d=m.name,e(Ve(p,c)),s(c),f(d)),j(i),e(Le(o)),e(Ke(i)),e(qe(l))),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),console.log(a.t0);case 14:case"end":return a.stop()}}),a,null,[[0,11]])})))()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"\u0413\u043b\u0430\u0432\u043d\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430"),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"\u0412\u0430\u0448\u0438 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438:"),r.a.createElement("div",null)):r.a.createElement(r.a.Fragment,null,o.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null," \u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0439 ",O.name+" "+O.surname,", \u0412\u044b \u044f\u0432\u043b\u044f\u0435\u0442\u0435\u0441\u044c \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u043e\u043c \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438: ",E)):r.a.createElement("p",null," \u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0439 ",O.name+" "+O.surname,", \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435, \u043f\u043e\u043a\u0430 \u0412\u0430\u0441 \u0434\u043e\u0431\u0430\u0432\u044f\u0442 \u0432 \u0441\u043f\u0438\u0441\u043e\u043a \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u043e\u0432 \u043d\u0430 \u0441\u0430\u0439\u0442\u0435 ")))},Ye=function(e){var t=e.name;return r.a.createElement("div",null,t)};function Ze(e){var t=e.open,a=e.handleClose,c=e.orgID,l=Object(n.useState)(""),o=Object(p.a)(l,2),s=o[0],m=o[1],d=Object(k.b)(),E=function(){var e=Object(i.a)(u.a.mark((function e(){var t,n,r,l,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(),t=JSON.parse(localStorage.getItem("redux")),n=t.user.userID,console.log(n),e.prev=3,r={nameDepart:s,userID:n,orgID:c},e.next=7,fetch("".concat("https://workkeeper.ru","/department"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 7:return l=e.sent,e.next=10,l.json();case 10:o=e.sent,console.log("\u041f\u041e\u0421\u041b\u0415 \u0414\u041e\u0411\u0410\u0412\u041b\u0415\u041d\u0418\u042f \u0414\u0415\u041f\u0410\u0420\u0422\u041c\u0415\u041d\u0422\u0410",o),l.ok&&(d(re(c,o)),d(ne(c,o._id))),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Q.a,{open:t,onClose:a,"aria-labelledby":"form-dialog-title"},r.a.createElement(ae.a,{id:"form-dialog-title"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0442\u0434\u0435\u043b"),r.a.createElement(ee.a,null,r.a.createElement(te.a,null,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043e\u0442\u0434\u0435\u043b\u0430/\u043f\u043e\u0434\u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u044f:"),r.a.createElement("form",null,r.a.createElement(O.a,{margin:"dense",id:"name",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",type:"text",fullWidth:!0,onChange:function(e){return m(e.target.value)},autoFocus:!0}))),r.a.createElement($.a,null,r.a.createElement(j.a,{onClick:a,color:"primary"},"\u041e\u0442\u043c\u0435\u043d\u0430"),r.a.createElement(j.a,{onClick:E,color:"primary"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")))}var Xe=function(e){var t=e.organizations;console.log("RENDER OrgINFO"),console.log(t);var a=Object(y.h)().id,c=Object(n.useState)({}),l=Object(p.a)(c,2),o=l[0],u=l[1],i=Object(y.g)(),s=r.a.useState(!1),d=Object(p.a)(s,2),E=d[0],f=d[1],b=Object(k.c)((function(e){return e.departments[a]}))||[];console.log("depArray",b),Object(n.useEffect)((function(){var e=t.find((function(e){return e._id===a}));console.log("FFFFFFFFFF",e),e&&u(Object(m.a)({},e))}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438"),Object.keys(o).length?r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement("h1",null,o.name),r.a.createElement("p",null,"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043e\u0442\u0434\u0435\u043b\u044b/\u043f\u043e\u0434\u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0432\u0430\u0448\u0435\u0439 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438 "),r.a.createElement(j.a,{variant:"outlined",color:"primary",onClick:function(){f(!0)}},"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0442\u0434\u0435\u043b"),E&&r.a.createElement(Ze,{open:E,handleClose:function(){f(!1)},orgID:o._id}),r.a.createElement("div",null,b.length?r.a.createElement("ul",{className:"dep-list "},b.map((function(e){return console.log(">>>>>>>>>>",e),r.a.createElement(oe.b,{to:"/department/".concat(e._id),key:e._id},r.a.createElement("li",{className:"dep-list-task"},r.a.createElement(Ye,e)))}))):r.a.createElement("p",null,"\u041d\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043e\u0442\u0434\u0435\u043b\u043e\u0432")),r.a.createElement("button",{onClick:function(){i.goBack()},type:"button",className:"btn btn-primary mt-5"},"Back")):null)};function Qe(e){var t=e.handleClose,a=e._id,c=e.open,l=e.orgID,o=e.setAddWorker,s=e.setMesFromBack;console.log(a);var m=Object(n.useState)(""),d=Object(p.a)(m,2),E=d[0],f=d[1],b=Object(k.b)(),g=function(){var e=Object(i.a)(u.a.mark((function e(){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(),e.prev=1,n={workerEmail:E},e.next=5,fetch("".concat("https://workkeeper.ru","/department/").concat(a),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 5:return r=e.sent,e.next=8,r.json();case 8:if(c=e.sent,console.log("\u041f\u041e\u0421\u041b\u0415 \u0414\u041e\u0411\u0410\u0412\u041b\u0415\u041d\u0418\u042f WORKER-a",c),!r.ok){e.next=13;break}return b(ce(l,a,c)),e.abrupt("return",o(c));case 13:return e.abrupt("return",s(c.message));case 16:e.prev=16,e.t0=e.catch(1),s(e.t0.message),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Q.a,{open:c,onClose:t,"aria-labelledby":"form-dialog-title"},r.a.createElement(ae.a,{id:"form-dialog-title"},"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 email \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0430"),r.a.createElement(ee.a,null,r.a.createElement("form",null,r.a.createElement(O.a,{margin:"dense",id:"name",label:"Email",type:"text",fullWidth:!0,onChange:function(e){return f(e.target.value)},autoFocus:!0}))),r.a.createElement($.a,null,r.a.createElement(j.a,{onClick:t,color:"primary"},"\u041e\u0442\u043c\u0435\u043d\u0430"),r.a.createElement(j.a,{onClick:g,color:"primary"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")))}var $e=function(){console.log("RENDER WorkerInfo");var e=Object(y.h)().id;console.log(e,"WorkerInfo");var t=Object(n.useState)({}),a=Object(p.a)(t,2),c=a[0],l=a[1],o=Object(y.g)(),u=Object(k.c)((function(e){return e.department.workers}));console.log("WorkerInfo_________workersArr",u),Object(n.useEffect)((function(){console.log("THIS WORKER",e);var t=u.find((function(t){return t._id===e}));console.log("THIS WORKER",t),l(t)}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u0442\u0434\u0435\u043b\u0430"),Object.keys(c).length?r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement("h1",null,c.name+" "+c.surname),r.a.createElement("p",null,"Email: ",c.email),r.a.createElement("button",{onClick:function(){o.goBack()},type:"button",className:"btn btn-primary mt-5"},"Back")):null)},et=function(e){var t=e.workersArr,a=void 0===t?[]:t;return console.log("WorkersList_workersArr",a),r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement("hr",null),a.length?r.a.createElement("ul",{className:"worker-list list-group"},a.map((function(e){return console.log("\u0420\u0430\u0431\u043e\u0442\u043d\u0438\u043aID",e._id),r.a.createElement(oe.b,{to:"/worker/".concat(e._id),key:e._id},r.a.createElement("li",{className:"worker-list-task list-group-item"},e.name+" "+e.surname))}))):r.a.createElement("p",null,"\u041d\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u043e\u0432"))},tt=function(e){var t=e.organizations;console.log("RENDER DepartmentInfo");var a=Object(y.h)().id,c=Object(k.b)(),l=Object(n.useState)({}),o=Object(p.a)(l,2),u=o[0],i=o[1],s=Object(n.useState)({}),m=Object(p.a)(s,2),d=m[0],E=m[1],f=Object(n.useState)(""),b=Object(p.a)(f,2),g=b[0],O=b[1],v=Object(y.g)(),h=Object(n.useState)(!1),I=Object(p.a)(h,2),N=I[0],S=I[1],_=Object(n.useState)(""),w=Object(p.a)(_,2),D=w[0],C=w[1],x=Object(k.c)((function(e){return e.departments})),R=Object(k.c)((function(e){return e.department.workers}));console.log("workersArr",R),Object(n.useEffect)((function(){var e,n=t.find((function(e){return e.departments.find((function(e){return e===a}))}))._id;if(n){var r=x[n].find((function(e){return e._id=a}));i(r),O(n),c((e=r,console.log(e,"depObject"),{type:"DEP_ACTUAL",payload:e}))}}),[d]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043e\u0442\u0434\u0435\u043b\u0430"),Object.keys(u).length?r.a.createElement("div",{className:"d-flex flex-column align-items-center"},r.a.createElement("h1",null,u.name),r.a.createElement(j.a,{variant:"outlined",color:"primary",onClick:function(){S(!0)}},"+ \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0430"),D&&r.a.createElement("span",{style:{color:"red",fontSize:"small"}}," "+D),N&&r.a.createElement(Qe,Object.assign({open:N,handleClose:function(){S(!1)}},u,{orgID:g,setAddWorker:E,setMesFromBack:C})),r.a.createElement("div",null,r.a.createElement(et,{workersArr:R,mesFromBack:D})),r.a.createElement("button",{onClick:function(){v.goBack()},type:"button",className:"btn btn-primary mt-5"},"Back")):null)};var at=function(){var e=Object(k.c)((function(e){return e.aboutMe})),t=(Object(k.c)((function(e){return e.user})),Object(k.c)((function(e){return e.organizations})));return console.log(e.isCreator,"ISCREATOR"),r.a.createElement("div",{className:"App"},r.a.createElement(ie.Provider,{value:e.isCreator},r.a.createElement(Ue,null,r.a.createElement(y.d,null,r.a.createElement(y.b,{exact:!0,path:"/user/registration"},r.a.createElement(w,null)),r.a.createElement(y.b,{exact:!0,path:"/user/login"},r.a.createElement(D,null)),r.a.createElement(y.b,{exact:!0,path:"/organization/:id"},r.a.createElement(Xe,{organizations:t})),r.a.createElement(y.b,{exact:!0,path:"/worker/:id"},r.a.createElement($e,{organizations:t})),r.a.createElement(y.b,{exact:!0,path:"/department/:id"},r.a.createElement(tt,{organizations:t})),r.a.createElement(y.b,{exact:!0,path:"/videochat",component:X}),r.a.createElement(x,{exact:!0,path:"/profile/:id"},r.a.createElement(se,null)),r.a.createElement(y.b,{exact:!0,path:"/"},e.isMe?r.a.createElement(He,null):r.a.createElement(y.a,{to:"/user/registration"})),r.a.createElement(y.b,{exact:!0,path:"/global-chat"},r.a.createElement(z,null))))))},nt=a(42),rt=function(){return JSON.parse(localStorage.getItem("redux"))||{aboutMe:{isMe:!1,isCreator:!1},user:{},organizations:[],departments:{},department:{}}},ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MAIN_USER":case"LOGIN":return Object(m.a)(Object(m.a)({},e),t.payload);case"LOGOUT":return{};default:return e}},lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IS_ME":return Object(m.a)(Object(m.a)({},e),{},{isMe:!0});case"IS_NOT_ME":return Object(m.a)(Object(m.a)({},e),{},{isMe:!1});case"MAIN_IS_CREATOR":return Object(m.a)(Object(m.a)({},e),{},{isCreator:t.payload.isCreator});default:return e}},ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ORG_ADD_ORG":return[].concat(Object(A.a)(e),[Object(m.a)({},t.payload)]);case"DEP_TO_ORG":return e.map((function(e){return e._id===t.payload.orgID?Object(m.a)(Object(m.a)({},e),{},{departments:[].concat(Object(A.a)(e.departments),[t.payload.depID])}):e}));case"MAIN_ORGANIZATIONS":return Object(A.a)(t.payload.organization);default:return e}},ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DEP_ADD_DEP":return Object(m.a)(Object(m.a)({},e),{},Object(s.a)({},t.payload.orgID,[].concat(Object(A.a)(e[t.payload.orgID]),[t.payload.depObject])));case"ORG_KEY_IN_DEP":return Object(m.a)(Object(m.a)({},e),{},Object(s.a)({},t.payload.orgID,[]));case"WORKER_TO_DEP":return Object(m.a)(Object(m.a)({},e),{},Object(s.a)({},t.payload.orgID,e[t.payload.orgID].map((function(e){return e._id===t.payload.depID?Object(m.a)(Object(m.a)({},e),{},{workers:[].concat(Object(A.a)(e.workers),[t.payload.workerObj])}):e}))));case"MAIN_DEPARTMENTS":return Object(m.a)(Object(m.a)({},e),{},Object(s.a)({},t.payload.orgID,Object(A.a)(t.payload.departments)));default:return e}},it=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DEP_ACTUAL":return Object(m.a)({},t.payload);default:return e}},st=Object(nt.combineReducers)({user:ct,aboutMe:lt,organizations:ot,departments:ut,department:it}),mt=a(151),pt=Object(mt.composeWithDevTools)(),dt=Object(nt.createStore)(st,rt(),pt);dt.subscribe((function(){localStorage.setItem("redux",JSON.stringify(dt.getState()))}));var Et=dt;l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(k.a,{store:Et},r.a.createElement(oe.a,null,r.a.createElement(at,null)))),document.getElementById("root"))}},[[163,1,2]]]);
//# sourceMappingURL=main.28553f0b.chunk.js.map